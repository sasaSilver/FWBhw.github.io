<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="comic-styles.css">
    <title>Comic</title>
    <script>
        async function fetchComicId(email) {
            const searchParams = new URLSearchParams({
                email: email
            });
            const response = await fetch("https://fwd.innopolis.university/api/hw2?" + searchParams);
            const comicId = await response.json();
            console.log(`Fetched comic id: ${comicId}`);
            return comicId;
        }
        async function fetchComicData(email) {
            const comicId = await fetchComicId(email);
            const searchParams = new URLSearchParams({
                id: comicId
            });
            const response = await fetch("https://fwd.innopolis.university/api/comic?" + searchParams);
            const comicData = await response.json();
            console.log(`Fetched comic data: ${comicData}`);
            return comicData;
        }
        async function displayComic(email) {
            const comicData = await fetchComicData(email);
            const imgElement = document.createElement("img");
            imgElement.src = comicData.img;
            imgElement.alt = comicData.alt;
            const titleElement = document.createElement("h2");
            titleElement.textContent = comicData.safe_title;
            const imgDate = new Date(comicData.year, comicData.month, comicData.day);
            const dateElement = document.createElement("p");
            dateElement.textContent = imgDate.toLocaleDateString();
            let comicContainer = document.createElement("div");
            comicContainer.appendChild(imgElement);
            comicContainer.appendChild(titleElement);
            comicContainer.appendChild(dateElement);
            document.body.appendChild(comicContainer);
            console.log("Appended comic");
        }
        const email = "al.mikhailov@innopolis.university";
        displayComic(email);
    </script>
</head>
<body>
</body>
</html>